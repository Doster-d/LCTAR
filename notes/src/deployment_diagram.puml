@startuml
title LCTAR - Deployment Architecture
left to right direction

' ===== Actors =====
actor "End Users" as Users <<Actor>>
actor "Administrators" as Admins <<Actor>>

' ===== Edge / Network =====
package "Edge / Network" {
  cloud "CDN" as CDN <<Edge>>
  node "Nginx (Reverse Proxy)" as Nginx <<Edge>>
}

' ===== Cluster =====
package "Kubernetes Cluster" {
  folder "Namespace: lctar-prod" {

    node "Frontend Pod" as FrontendPod <<Pod>> {
      component "React SPA" as ReactApp <<Frontend>>
      component "WASM (AprilTag)" as WASM <<Frontend>>
    }

    node "Backend Pod" as BackendPod <<Pod>> {
      component "FastAPI" as FastAPI <<API>>
      component "AI/ML Services" as AIServices <<AI>>
    }

    node "Database Pod" as DBPod <<Pod>> {
      database "PostgreSQL" as PostgreSQL <<DB>>
    }
  }
}

' ===== Flows =====
Users --> CDN : GET static assets
Users --> Nginx : HTTPS
Admins --> Nginx : HTTPS (admin)
CDN --> Nginx : cache miss

Nginx --> ReactApp : / (static fallback)
Nginx --> FastAPI : /api/*

ReactApp ..> WASM : JS calls
ReactApp --> FastAPI : REST/JSON
