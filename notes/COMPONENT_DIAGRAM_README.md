# LCTAR Component Architecture Diagram

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

LCTAR (Location-based AR Quest System) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –º—É–∑–µ–µ–≤ –∏ –ø–∞—Ä–∫–æ–≤, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –Ω–∞ –±–∞–∑–µ –≤–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### üñ•Ô∏è Frontend (React)
- **App.jsx** - –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **SceneComponent.jsx** - 3D —Å—Ü–µ–Ω–∞ —Å Three.js
- **ApriltagPipeline.jsx** - –ü–∞–π–ø–ª–∞–π–Ω –¥–µ—Ç–µ–∫—Ü–∏–∏ AprilTag –º–µ—Ç–æ–∫
- **AlvaBridge.jsx** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SLAM —Å–∏—Å—Ç–µ–º–æ–π AlvaAR
- **ConsolePanel.jsx** - –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ –∏ –ª–æ–≥–æ–≤
- **Landing.jsx** - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

### üéÆ 3D Rendering Engine
- **Three.js** - 3D –≥—Ä–∞—Ñ–∏–∫–∞ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
- **React Three Fiber** - React-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è Three.js
- **WebGL Context** - –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ

### üëÅÔ∏è Computer Vision
- **AprilTag WASM** - WebAssembly –º–æ–¥—É–ª—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ AprilTag
- **OpenCV.js** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- **Camera API** - –ó–∞—Ö–≤–∞—Ç –≤–∏–¥–µ–æ —Å –∫–∞–º–µ—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### ‚ö° Backend (FastAPI)
- **API Routes** - REST —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- **Models** - SQLAlchemy –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- **Services** - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã
- **AI/ML Pipeline** - –ú–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### ü§ñ AI/ML Services
- **YOLO Model** - –î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
- **Depth Model** - –û—Ü–µ–Ω–∫–∞ –≥–ª—É–±–∏–Ω—ã —Å—Ü–µ–Ω—ã
- **Height Calculation** - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞ –æ–±—ä–µ–∫—Ç–æ–≤

### üóÑÔ∏è Database (PostgreSQL)
- **Users** - –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Characters** - –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç
- **Videos** - –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
- **Client Logs** - –õ–æ–≥–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
- **Quest Sessions** - –°–µ—Å—Å–∏–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫–≤–µ—Å—Ç–æ–≤
- **Achievements** - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –Ω–∞–≥—Ä–∞–¥—ã
- **Coupons** - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫—É–ø–æ–Ω—ã

### üåê External Services
- **CDN (CloudFront)** - –î–æ—Å—Ç–∞–≤–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- **WebRTC Service** - P2P –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- **Authentication Provider** - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üèóÔ∏è Infrastructure
- **Docker** - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Nginx** - Reverse proxy –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏
- **Redis Cache** - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Monitoring** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ observability

### üöÄ Deployment Architecture
- **Container Orchestration** - Docker Compose –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **Load Balancing** - Nginx reverse proxy —Å health checks
- **Security Layer** - SSL/TLS, Firewall, WAF, DDoS protection
- **Monitoring Stack** - Prometheus metrics, Grafana dashboards
- **Storage Solutions** - Persistent volumes –¥–ª—è –ë–î, S3 –¥–ª—è assets
- **CDN Distribution** - Global static asset distribution
- **Scalability** - Horizontal scaling with load balancer

### üéØ Core Systems
- **AprilTag Detection** - –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
- **SLAM System** - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∫–∞—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Gamification Engine** - –ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –∏ –Ω–∞–≥—Ä–∞–¥—ã

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### Frontend ‚Üî Backend
- REST API –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –∫–≤–µ—Å—Ç–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- WebSocket –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- JSON –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### Computer Vision Pipeline
- –ü–æ—Ç–æ–∫ –≤–∏–¥–µ–æ –æ—Ç –∫–∞–º–µ—Ä—ã –∫ —Å–∏—Å—Ç–µ–º–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ AprilTag
- WebAssembly –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- OpenCV.js –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 3D Rendering
- Three.js –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ 3D –≥—Ä–∞—Ñ–∏–∫–∏
- React Three Fiber –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å React
- WebGL –¥–ª—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è

### Data Flow
```
Frontend ‚Üí Backend (POST /api/quest/*)
Backend ‚Üí Database (CRUD operations)
Database ‚Üí Backend (query results)
Backend ‚Üí Frontend (JSON responses)
```

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π** - React, FastAPI, PostgreSQL
2. **WebAR –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏** - –†–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
3. **–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ** - Real-time –¥–µ—Ç–µ–∫—Ü–∏—è AprilTag —á–µ—Ä–µ–∑ WebAssembly
4. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π backend
5. **–ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞** - –°–∏—Å—Ç–µ–º–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
6. **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤
7. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** - –õ–µ–≥–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- React 18+
- Three.js / React Three Fiber
- AprilTag WebAssembly
- OpenCV.js
- TypeScript

### Backend
- FastAPI (Python)
- SQLAlchemy ORM
- PostgreSQL
- YOLO / Depth Models
- Redis Cache

### Infrastructure
- Docker & Docker Compose
- Nginx
- AWS S3 / CloudFront
- Monitoring (Prometheus/Grafana)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- WebAssembly –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ Redis
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ 3D –º–æ–¥–µ–ª–∏
- Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üìä Deployment Diagram

–û—Ç–¥–µ–ª—å–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (`deployment_diagram.puml`) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è LCTAR —Å–∏—Å—Ç–µ–º—ã:

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫:**
- End Users –∏ Administrators –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ HTTPS
- Nginx reverse proxy –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- SSL/TLS termination –∏ rate limiting –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:**
- **Frontend Container**: React SPA —Å Three.js –∏ WebAssembly
- **Backend Container**: FastAPI —Å–µ—Ä–≤–µ—Ä —Å AI/ML —Å–µ—Ä–≤–∏—Å–∞–º–∏
- **Database Container**: PostgreSQL —Å connection pooling

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- **Monitoring Stack**: Prometheus, Grafana, AlertManager
- **Storage & Cache**: Redis, S3, persistent volumes
- **Security**: Firewall, DDoS protection, WAF

**–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã:**
- **CDN (CloudFront)**: –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö assets
- **DNS Provider**: –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- **SSL Certificates**: –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: Horizontal scaling —á–µ—Ä–µ–∑ load balancer
2. **–í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: Health checks –∏ monitoring
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ (SSL, Firewall, WAF, DDoS)
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤, Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ–ª–Ω–∞—è observability —á–µ—Ä–µ–∑ Prometheus/Grafana
6. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢—Ä–∞—Ñ–∏–∫ Flow

```mermaid
Users ‚Üí Nginx (SSL/443) ‚Üí Frontend/Backend Containers
Frontend ‚Üí Backend API ‚Üí PostgreSQL Database
Static Assets ‚Üí S3 ‚Üí CloudFront CDN ‚Üí Users
All Components ‚Üí Prometheus ‚Üí Grafana Dashboards
```

---

*–î–∏–∞–≥—Ä–∞–º–º—ã —Å–æ–∑–¥–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PlantUML –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã LCTAR —Å–∏—Å—Ç–µ–º—ã*