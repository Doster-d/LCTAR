@startuml schema1
autonumber
actor Visitor as V
participant "WebAR SPA" as SPA
participant CDN
participant "Stats API" as API
participant "Coupon Service" as RWD

V -> SPA: Open QR link
V -> SPA: Select language
SPA -> CDN: GET assets (GLB, sfx, locales)
CDN --> SPA: 200 + assets (cached)
V -> SPA: Point at figure / AprilTag
SPA -> SPA: Track image / AprilTag
SPA -> SPA: Render AR scene
SPA -> API: POST /progress {sessionId, pointId}
API --> SPA: 200
alt Progress < 4
SPA -> V: Show progress n/4
SPA -> V: Show hint
else Progress == 4
SPA -> RWD: POST /reward/issue {sessionId, type}
RWD --> SPA: {token, qr}
SPA -> V: Show coupon screen
end
@enduml